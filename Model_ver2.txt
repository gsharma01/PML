# load data
trainRawData <- read.csv("pml-training.csv",na.strings=c("NA",""))
# discard NAs
NAs <- apply(trainRawData,2,function(x) {sum(is.na(x))}) 
validData <- trainRawData[,which(NAs == 0)]
# make training set
trainIndex <- createDataPartition(y = validData$classe, p=0.2,list=FALSE) # 3927 rows
trainData <- validData[trainIndex,]
# discards unuseful predictors
removeIndex <- grep("timestamp|X|user_name|new_window",names(trainData))
trainData <- trainData[,-removeIndex]
training<-trainData

#Cross Validation and Out of Sample Error

k=10
foldSize <- floor(nrow(training)/k)

errVect<- rep(NA,k)
i=1
Set1<- ((i-1)*n+1)
Set2<- (i*n)




# make model
modFit <- train(trainData$classe ~.,data = trainData,method="rpart")
modFit